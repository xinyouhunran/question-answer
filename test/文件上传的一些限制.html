<!DOCTYPE HTML>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org">
<head>
<title></title>
<meta charset="UTF-8" />
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<link rel="stylesheet" href="../../static/assets/bootstrap-3.3.7/css/bootstrap.min.css" />
<link rel="stylesheet" href="../../static/css/bootstrap-table.min.css" />
<link rel="stylesheet" href="../../static/assets/adminlte-2.3.7/css/AdminLTE.min.css" />
<!--[if lt IE 9]>
<script src="../../static/js/html5shiv.min.js" th:src="@{../../static/js/html5shiv.min.js}"></script>
<script src="../../static/js/respond.min.js" th:src="@{../../static/js/respond.min.js}"></script>
<!--[endif]-->
<style type="text/css">
    body{
        background-color: #eee;
    }
    .mypic{
    	overflow: hidden;
    }
    .mypic img{
    	float: left;
    	width: 100%;
    	cursor: pointer;
    }
    .weui-uploader__input-box{
    	float: left;
		position: relative;
		margin-right: 20px;
		margin-bottom: 9px;
		width: 77px;
		height: 77px;
		border: 1px solid #d9d9d9;
    }
    .weui-uploader__input-box:before {
    width: 2px;
    height: 39.5px;
}
.weui-uploader__input-box:after {
    width: 39.5px;
    height: 2px;
}
.myheng:after{
	width: 39.5px;
    height: 2px;
	z-index: -1;
}
.weui-uploader__input-box:after, .weui-uploader__input-box:before {
    content: " ";
    position: absolute;
    top: 50%;
    left: 50%;
    -webkit-transform: translate(-50%,-50%);
    transform: translate(-50%,-50%);
    background-color: #d9d9d9;
}
.weui-uploader__input {
	cursor: pointer;
    position: absolute;
    z-index: 1;
    top: 0;
    left: 0;
    width: 100%;
    height: 75%;
    opacity: 0;
    -webkit-tap-highlight-color: rgba(0,0,0,0);
}
#uploadFilesDiv{
	overflow: hidden;
}
.myfl{
	float: left;
	position: relative;
	width: 100%;height: 100%;
}
.myfl span{
	position: absolute;width: 20px;height: 20px;right: -15px;top: -15px;
}
.mymessage{
	color: #aaa;
}
.myfl p{
	position: absolute;
    background: #000000;
    opacity: 0.5;
    bottom: 0;
    width: 100%;
    height: 25%;
    margin: 0;
    text-align: center;
    color: #fff;
    cursor: pointer;
    display: none;
}
    </style>
</head>
<body>
<section class="content">
    <div class="row">
        <div class="col-md-12">
            <div class="box box-primary">
                <div class="box-header with-border">
                	<a href="javascript: history.back();" class="box-title">返回</a>
                    <h3 class="box-title" >修改一体机</h3>
                </div>
                <div class="box-body">
                    <form class="form-horizontal" enctype="multipart/form-data">
                        <input type="hidden" name="aioId"  />
                        <div class="form-group">
                            <label for="aioName" class="col-sm-2 control-label">一体机名称(安放点)</label>
                            <div class="col-sm-10">
                                <input type="text" name="aioName" class="form-control" id="aioName" required="required"  placeholder="请输入一体机名称" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="address" class="col-sm-2 control-label">一体机地址</label>
                            <div class="col-sm-10">
                                <input type="text" name="address" class="form-control" id="address"  placeholder="请输入一体机地址" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="longitude" class="col-sm-2 control-label">经度</label>
                            <div class="col-sm-10">
                                <input type="text" name="longitude" class="form-control" id="longitude"  placeholder="经度" />
                            </div>
                        </div>    
                        <div class="form-group">
                            <label for="latitude" class="col-sm-2 control-label">纬度</label>
                            <div class="col-sm-10">
                                <input type="text" name="latitude" class="form-control" id="latitude"  placeholder="纬度" />
                            </div>
                        </div>
                         <div class="form-group">
                            <label for="dutyPhones" class="col-sm-2 control-label">值班电话</label>
                            <div class="col-sm-10">
                                <input type="text" name="dutyPhones" class="form-control" id="dutyPhones"  placeholder="请输入值班电话" />
                            </div>
                        </div>                    
                        <div class="form-group">
                            <label for="serviceContent" class="col-sm-2 control-label">业务内容</label>
                            <div class="col-sm-10">
                                <input type="text" name="serviceContent" class="form-control" id="serviceContent"  placeholder="请输入业务内容" />
                            </div>
                        </div>
                         <div class="form-group">
                            <label for="note" class="col-sm-2 control-label">备注</label>
                            <div class="col-sm-10">
                                <input type="text" name="note" class="form-control" id="note" />
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="status" class="col-sm-2 control-label">是否启用</label>
                            <div class="col-sm-10">
                                <select name="status" class="form-control" id="status">
                                    <option value="1" th:selected="${aio.status eq 1}">是</option>
                                    <option value="0" th:selected="${aio.status eq 0}">否</option>
                                </select>
                            </div>
                        </div>
                         <div class="form-group">
                            <label for="serviceTime" class="col-sm-2 control-label">服务时间</label>
                            <div class="col-sm-10">
                                <input type="text" name="serviceTime" class="form-control" id="serviceTime" />
                            </div>
                        </div>
                         <div class="form-group">
                            <label for="districtId" class="col-sm-2 control-label">所属区域</label>
                            <div class="col-sm-10">
                                <select name="districtId" class="form-control" id="status">
                                    <option value="1" >福田区</option>
                                    <option value="2" >罗湖区</option>
                                    <option value="3" >南山区</option>
                                    <option value="4" >盐田区</option>
                                    <option value="5" >宝安区</option>
                                    <option value="6" >龙岗区</option>
                                    <option value="7" >龙华区</option>
                                    <option value="8" >坪山区</option>
                                    <option value="9" >光明区</option>
                                    <option value="10" >大鹏新区</option>
                                    
                                </select>
                            </div>
                        </div>   
                        <div class="form-group mypic">
                        	<label for="pic" class="col-sm-2 control-label">图片</label>
                        	<div class="col-sm-10">
                        		<div class="weui-uploader__bd upload_area" style="overflow: hidden;padding: 20px;">
                                    <div class="weui-uploader__input-box">
                                    	<div class="myfl">
	                                        <input style="cursor: pointer;" data-index="0" name="uploadFiles" class="weui-uploader__input uploaderInput" type="file" accept="image/*" multiple/>
	                                    	<span data-index="0"><img src="https://msjwt.szga.gov.cn/jwdzdt/static/img/button-cross.png" alt="" /></span>
	                                    	<p>查看大图</p>
                                    	</div>
                                    </div>
                                    <div class="weui-uploader__input-box">
                                    	<div class="myfl">
	                                        <input style="cursor: pointer;" data-index="1" name="uploadFiles" class="weui-uploader__input uploaderInput" type="file" accept="image/*" multiple/>
	                                    	<span data-index="1"><img src="https://msjwt.szga.gov.cn/jwdzdt/static/img/button-cross.png" alt="" /></span>
                                    		<p>查看大图</p>
                                    	</div>
                                    </div>
                                    <div class="weui-uploader__input-box">
                                    	<div class="myfl">
	                                        <input style="cursor: pointer;" data-index="2" name="uploadFiles" class="weui-uploader__input uploaderInput" type="file" accept="image/*" multiple>
	                                    	<span data-index="2"><img src="https://msjwt.szga.gov.cn/jwdzdt/static/img/button-cross.png" alt="" /></span>
                                    		<p>查看大图</p>
                                    	</div>
                                    </div>
                                </div>
                                <div class="mymessage">
                                	<span>（最多上传三张图片）</span>
                                </div>
                        	</div>
                        </div>
                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <button type="button" class="btn btn-primary ">提交</button>
                            </div>
                        </div>
						                        
                        <div id="container" style="height:300px"></div>
                    </form>
                    
                </div>
            </div>
        </div>
    </div>
</section>

<!-- 点击图片放大查看 -->
<div id="outerdiv"
     style="position:fixed;top:0;left:0;background:rgba(0,0,0,0.7);z-index:20000;width:100%;height:100%;display:none;">
    <div id="innerdiv" style="position:absolute;top:50%;left: 50%;">
        <img id="bigimg" style="border:5px solid #fff;" src=""/>
    </div>
</div>
</body>
<script type="text/javascript" src="../../static/js/global.js" ></script>
<script type="text/javascript" src="jquery-1.11.1.min.js" ></script>
<script type="text/javascript" src="../../static/js/jquery.form.min.js" ></script>
<script type="text/javascript" src="../../static/js/jquery.validate.min.js" ></script>
<script type="text/javascript" src="../../static/assets/bootstrap-3.3.7/js/bootstrap.min.js" ></script>
<script type="text/javascript" src="../../static/js/messages_zh.min.js" ></script>
<script type="text/javascript" src="../../static/js/layer.js" ></script>

<!--<script type="text/javascript">
$(function(){
	initPage("aio");
})

</script>-->
<script type="text/javascript">
	var arrPic = [0,1,2];//记录初始加载的图片url
	var imgArr = [0,0,0];//默认图片数组为3个
	var maxSize = 5120000;//5Mb
	
	$(".myfl").css("background","none");
	$(".mypic").on('change','.uploaderInput',function(evt){
		var files = evt.target.files;
		var _this = this;
		var myindex = $(this).attr("data-index");
		/*console.log(myindex);
		console.log(imgArr,files.length);*/
		/*console.log($(_this));*/
	    for(var i = 0,f,len = files.length; i < len; i++){
	    	f = files[i];
	    	/*console.log(f);*/
	        // 过滤掉非图片类型文件
	        if(!f.type.match('image.*')){
	            continue;
	        }
	        // 过滤掉重复上传的图片
	        console.log($(this).val());//可以得到此文本框的值
	        if (imgArr.indexOf(f.name) != -1) {
                    return alert('已上传的图片不能再次上传!');

                }
	        /*console.log(f.size);*/
	        // 设置文件大小限制
	        if(f.size>maxSize){
	        	return alert('图片大小不能超过5MB');
	        }
            imgArr.splice(myindex,1,f.name);//替换
            console.log(imgArr);
            var reader = new FileReader();
            reader.onload = (function (theFile) {
                return function (e) {
                	/*$(_this).prev().attr("src",e.target.result);*/
                	console.log(theFile);
                	console.log(e);
                	$(_this).parent().css({"background":"url("+e.target.result+") no-repeat center","background-size":"cover"});
                	$(_this).parent().parent().addClass('myheng');
                	$(_this).parent().attr("data-name",theFile.name);
                	$(_this).parent().attr("data-src",e.target.result);
                };
            })(f);
            reader.readAsDataURL(f);
            break;//此操作是为了无论你选几张图片，我只加载第一次
	    }
	})
	 $(".mypic").on("click","span",function(){//删除
				/*console.log(1);*/
				console.log(imgArr);
				var myindex = $(this).attr("data-index");
				console.log(myindex);
				if($(this).parent().attr("data-name")!=undefined){
					console.log($(this).parent().attr("data-name"));
					var myname = $(this).parent().attr("data-name");
					var index = imgArr.indexOf(myname);
					if(index>-1){
						imgArr.splice(myindex,1,0);//替换，将指定位置替换成0
					}
					/*$(this).parent().css("background","none");*/
					$(this).parent().parent().remove();
					var str = `<div class="weui-uploader__input-box">
                                    	<div class="myfl">
	                                        <input style="cursor: pointer;" data-index="${myindex}" name="uploadFiles" class="weui-uploader__input uploaderInput" type="file" accept="image/*" multiple>
	                                    	<span data-index="${myindex}"><img src="https://msjwt.szga.gov.cn/jwdzdt/static/img/button-cross.png" alt="" /></span>
	                                    	<p>查看大图</p>
                                    	</div>
                                    </div>`;
                    $(".upload_area").append(str);
					$(this).parent().parent().removeClass('myheng');
					console.log(imgArr);
				}
			})
	
	$(".mypic").on("mouseover",".myfl",function(){
		var mysrc = $(this).attr("data-src");
		console.log(mysrc);
		if(mysrc!=undefined){
			$(this).find("p").show();
		}
		$(".mypic").on("click",".myfl p",function(){
			imgShow("#outerdiv", "#innerdiv", "#bigimg",mysrc);
		})
	})
	$(".mypic").on("mouseout",".myfl",function(){
		$(this).find("p").hide();
	})
	
	
	function imgShow(outerdiv, innerdiv, bigimg, src) {
        $(innerdiv).css({
            "top": "50%",
            "left": "50%",
            "marginLeft": "-50px",
            "marginTop": "-50px"
        });
        $(bigimg).hide();
        /*$("#loading-img").show();*/
        //var src = _this.attr("src"); //获取当前点击的pimg元素中的src属性
        $(bigimg).attr("src", src); //设置#bigimg元素的src属性
        $(outerdiv).fadeIn("fast");

        /*获取当前点击图片的真实大小，并显示弹出层及大图*/
        $("<img/>").attr("src", src).load(function () {
            var windowW = $(window).width(); //获取当前窗口宽度
            var windowH = $(window).height(); //获取当前窗口高度
            var realWidth = this.width; //获取图片真实宽度
            var realHeight = this.height; //获取图片真实高度
            var imgWidth, imgHeight;
            var scale = 0.8; //缩放尺寸，当图片真实宽度和高度大于窗口宽度和高度时进行缩放

            if (realHeight > windowH * scale) { //判断图片高度
                imgHeight = windowH * scale; //如大于窗口高度，图片高度进行缩放
                imgWidth = imgHeight / realHeight * realWidth; //等比例缩放宽度
                if (imgWidth > windowW * scale) { //如宽度扔大于窗口宽度
                    imgWidth = windowW * scale; //再对宽度进行缩放
                }
            } else if (realWidth > windowW * scale) { //如图片高度合适，判断图片宽度
                imgWidth = windowW * scale; //如大于窗口宽度，图片宽度进行缩放
                imgHeight = imgWidth / realWidth * realHeight; //等比例缩放高度
            } else { //如果图片真实高度和宽度都符合要求，高宽不变
                imgWidth = realWidth;
                imgHeight = realHeight;
            }
            $(bigimg).css("width", imgWidth); //以最终的宽度对图片缩放

            var w = (windowW - imgWidth) / 2; //计算图片与窗口左边距
            var h = (windowH - imgHeight) / 2; //计算图片与窗口上边距
            $(innerdiv).css({
                "top": h,
                "left": w,
                "marginLeft": "0px",
                "marginTop": "0px"
            }); //设置#innerdiv的top和left属性
            /*$("#loading-img").hide();*/
            $(bigimg).show();
            // $(outerdiv).fadeIn("fast"); //淡入显示#outerdiv及.pimg
        });

        $(outerdiv).click(function () { //再次点击淡出消失弹出层
            $(this).fadeOut("fast");
        });
    }
</script>
<script type="text/javascript" src="../../static/js/from.js" ></script>
</html>